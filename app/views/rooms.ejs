<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≤‡∏£‡∏≤‡πÇ‡∏≠‡πÄ‡∏Å‡∏∞ - Junrai Karaoke</title>
    <link rel="stylesheet" href="/stylesheets/global.css">
    <link rel="stylesheet" href="/stylesheets/rooms.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;">
                <a href="/" class="navbar-brand">
                    <i class="fas fa-microphone-alt"></i>
                    Junrai Karaoke
                </a>
                <ul class="navbar-nav">
                    <li><a href="/" class="nav-link">‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a></li>
                    <li><a href="/rooms" class="nav-link active">‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≤‡∏£‡∏≤‡πÇ‡∏≠‡πÄ‡∏Å‡∏∞</a></li>
                    <li><a href="/bookings" class="nav-link">‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á</a></li>
                    <li><a href="/contact" class="nav-link">‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤</a></li>
                    <li><a href="/dashboard" class="nav-link" id="dashboardLink" style="display: none;">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</a></li>
                    <li><a href="/admin" class="nav-link" id="adminLink" style="display: none;">‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</a></li>
                    <li><a href="/auth" class="nav-link" id="authLink" style="display: none;">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a></li>
                    <li><button class="btn btn-outline" id="logoutBtn" style="display: none;">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Page Header -->
        <div class="page-header">
            <h1><i class="fas fa-door-open"></i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≤‡∏£‡∏≤‡πÇ‡∏≠‡πÄ‡∏Å‡∏∞</h1>
            <p>‡∏î‡∏π ‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡πÅ‡∏•‡∏∞‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≤‡∏£‡∏≤‡πÇ‡∏≠‡πÄ‡∏Å‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</p>
        </div>

        <!-- Controls Section -->
        <div class="controls-section">
            <div class="search-filters">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡πâ‡∏≠‡∏á...">
                </div>
                
                <div class="filter-group">
                    <select id="statusFilter" class="form-select">
                        <option value="">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        <option value="available">‡∏ß‡πà‡∏≤‡∏á</option>
                        <option value="occupied">‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á</option>
                    </select>
                    
                    <select id="typeFilter" class="form-select">
                        <option value="">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                    </select>
                </div>
            </div>
            
            <button class="btn btn-primary" id="addRoomBtn" style="display: none;">
                <i class="fas fa-plus"></i>
                ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà
            </button>
        </div>

        <!-- Rooms Grid -->
        <div class="rooms-grid" id="roomsGrid">
            <div class="loading">
                <div class="spinner"></div>
                <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á...</p>
            </div>
        </div>

        <!-- Room Details Modal -->
        <div class="modal-overlay" id="roomModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalTitle">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏´‡πâ‡∏≠‡∏á</h3>
                    <button class="modal-close" onclick="closeModal()">&times;</button>
                </div>
                <div class="modal-body" id="modalBody">
                    <!-- Content will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Add/Edit Room Modal -->
        <div class="modal-overlay" id="roomFormModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="formModalTitle">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</h3>
                    <button class="modal-close" onclick="closeFormModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <form id="roomForm">
                        <input type="hidden" id="roomId">
                        
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-door-open"></i>
                                ‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á
                            </label>
                            <input type="text" class="form-control" id="roomName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡πâ‡∏≠‡∏á VIP 1" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-tags"></i>
                                ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡πâ‡∏≠‡∏á
                            </label>
                            <select class="form-select" id="roomType" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏´‡πâ‡∏≠‡∏á</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-users"></i>
                                ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏ (‡∏Ñ‡∏ô)
                            </label>
                            <input type="number" class="form-control" id="roomCapacity" min="1" max="50" placeholder="‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏î‡πâ" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">
                                <i class="fas fa-info-circle"></i>
                                ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                            </label>
                            <select class="form-select" id="roomStatus" required>
                                <option value="available">‡∏ß‡πà‡∏≤‡∏á</option>
                                <option value="occupied">‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á</option>
                            </select>
                        </div>
                        
                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" onclick="closeFormModal()">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save"></i>
                                ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let rooms = [];
        let roomTypes = [];
        let currentUser = null;
        const API_BASE = '/api';

        // Initialize page
        document.addEventListener('DOMContentLoaded', () => {
            initializeNavbar();
            checkAdminControls();
            loadRoomTypes();
            loadRooms();
        });

        // Check admin controls visibility
        function checkAdminControls() {
            const user = getCurrentUser();
            const userFromStorage = localStorage.getItem('user');
            
            let currentUser = user;
            if (userFromStorage) {
                try {
                    currentUser = JSON.parse(userFromStorage);
                } catch (e) {
                    console.warn('Failed to parse user from localStorage');
                }
            }
            
            // Show admin controls ONLY for admin users
            if (isAuthenticated() && currentUser && currentUser.role_id === 1) {
                const addRoomBtn = document.getElementById('addRoomBtn');
                if (addRoomBtn) {
                    addRoomBtn.style.display = 'block';
                }
                console.log('üîë Admin controls enabled in rooms page');
            } else {
                const addRoomBtn = document.getElementById('addRoomBtn');
                if (addRoomBtn) {
                    addRoomBtn.style.display = 'none';
                }
                console.log('üë• Customer user - admin controls hidden in rooms page');
            }
        }

        // Load room types for filters and form
        async function loadRoomTypes() {
            try {
                // For now, use static data since we don't have room_types API
                roomTypes = [
                    { type_id: 1, type_name: '‡∏´‡πâ‡∏≠‡∏á‡∏ò‡∏£‡∏£‡∏°‡∏î‡∏≤' },
                    { type_id: 2, type_name: '‡∏´‡πâ‡∏≠‡∏á VIP' },
                    { type_id: 3, type_name: '‡∏´‡πâ‡∏≠‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÉ‡∏´‡∏ç‡πà' }
                ];
                
                populateTypeFilters();
            } catch (error) {
                console.error('Error loading room types:', error);
            }
        }

        // Populate type filters
        function populateTypeFilters() {
            const typeFilter = document.getElementById('typeFilter');
            const roomTypeSelect = document.getElementById('roomType');
            
            roomTypes.forEach(type => {
                // Filter dropdown
                const filterOption = document.createElement('option');
                filterOption.value = type.type_id;
                filterOption.textContent = type.type_name;
                typeFilter.appendChild(filterOption);
                
                // Form select
                const formOption = document.createElement('option');
                formOption.value = type.type_id;
                formOption.textContent = type.type_name;
                roomTypeSelect.appendChild(formOption);
            });
        }

        // Load rooms
        async function loadRooms() {
            try {
                const response = await fetch(`${API_BASE}/rooms/roomForm`);
                if (response.ok) {
                    rooms = await response.json();
                    displayRooms(rooms);
                } else {
                    throw new Error('Failed to load rooms');
                }
            } catch (error) {
                console.error('Error loading rooms:', error);
                document.getElementById('roomsGrid').innerHTML = `
                    <div class="error-message">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h3>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</h3>
                        <p>‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á‡πÑ‡∏î‡πâ</p>
                        <button class="btn btn-primary" onclick="loadRooms()">‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á</button>
                    </div>
                `;
            }
        }

        // Display rooms
        function displayRooms(roomsToShow) {
            const grid = document.getElementById('roomsGrid');
            
            if (roomsToShow.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-door-closed"></i>
                        <h3>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏´‡πâ‡∏≠‡∏á‡∏Ñ‡∏≤‡∏£‡∏≤‡πÇ‡∏≠‡πÄ‡∏Å‡∏∞</h3>
                        <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏´‡∏£‡∏∑‡∏≠‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = roomsToShow.map(room => `
                <div class="room-card ${room.status}" onclick="viewRoom(${room.room_id})">
                    <div class="room-header">
                        <div class="room-status ${room.status}">
                            <i class="fas ${room.status === 'available' ? 'fa-check-circle' : 'fa-times-circle'}"></i>
                            ${room.status === 'available' ? '‡∏ß‡πà‡∏≤‡∏á' : '‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á'}
                        </div>
                        ${currentUser && currentUser.role_id === 1 ? `
                        <div class="room-actions">
                            <button class="action-btn edit" onclick="event.stopPropagation(); editRoom(${room.room_id})" title="‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="action-btn delete" onclick="event.stopPropagation(); deleteRoom(${room.room_id})" title="‡∏•‡∏ö">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        ` : ''}
                    </div>
                    
                    <div class="room-body">
                        <h3 class="room-name">
                            <i class="fas fa-door-open"></i>
                            ${room.name}
                        </h3>
                        
                        <div class="room-info">
                            <div class="info-item">
                                <i class="fas fa-tags"></i>
                                <span>${room.type_name || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó'}</span>
                            </div>
                            
                            <div class="info-item">
                                <i class="fas fa-users"></i>
                                <span>${room.capacity || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'} ‡∏Ñ‡∏ô</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="room-footer">
                        <button class="btn ${room.status === 'available' ? 'btn-primary' : 'btn-secondary'}" 
                                ${room.status !== 'available' ? 'disabled' : ''}>
                            <i class="fas ${room.status === 'available' ? 'fa-calendar-plus' : 'fa-ban'}"></i>
                            ${room.status === 'available' ? '‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á' : '‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á'}
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Search rooms
        function searchRooms() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;
            const typeFilter = document.getElementById('typeFilter').value;
            
            let filteredRooms = rooms.filter(room => {
                const matchesSearch = room.name.toLowerCase().includes(searchTerm) ||
                                    (room.type_name && room.type_name.toLowerCase().includes(searchTerm));
                const matchesStatus = !statusFilter || room.status === statusFilter;
                const matchesType = !typeFilter || room.type_id == typeFilter;
                
                return matchesSearch && matchesStatus && matchesType;
            });
            
            displayRooms(filteredRooms);
        }

        // Filter rooms
        function filterRooms() {
            searchRooms(); // Use the same logic
        }

        // View room details
        function viewRoom(roomId) {
            const room = rooms.find(r => r.room_id === roomId);
            if (!room) return;
            
            document.getElementById('modalTitle').textContent = `‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î${room.name}`;
            document.getElementById('modalBody').innerHTML = `
                <div class="room-details">
                    <div class="detail-item">
                        <label>‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á:</label>
                        <span>${room.name}</span>
                    </div>
                    
                    <div class="detail-item">
                        <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</label>
                        <span>${room.type_name || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</span>
                    </div>
                    
                    <div class="detail-item">
                        <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏:</label>
                        <span>${room.capacity || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'} ‡∏Ñ‡∏ô</span>
                    </div>
                    
                    <div class="detail-item">
                        <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</label>
                        <span class="badge badge-${room.status === 'available' ? 'success' : 'warning'}">
                            ${room.status === 'available' ? '‡∏ß‡πà‡∏≤‡∏á' : '‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏á'}
                        </span>
                    </div>
                    
                    <div class="detail-actions">
                        ${room.status === 'available' ? `
                        <button class="btn btn-primary" onclick="bookRoom(${room.room_id})">
                            <i class="fas fa-calendar-plus"></i>
                            ‡∏à‡∏≠‡∏á‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏µ‡πâ
                        </button>
                        ` : ''}
                        
                        ${currentUser && currentUser.role_id === 1 ? `
                        <button class="btn btn-secondary" onclick="editRoom(${room.room_id})">
                            <i class="fas fa-edit"></i>
                            ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                        </button>
                        ` : ''}
                    </div>
                </div>
            `;
            
            document.getElementById('roomModal').style.display = 'flex';
        }

        // Show add room modal
        function showAddRoomModal() {
            document.getElementById('formModalTitle').textContent = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà';
            document.getElementById('roomForm').reset();
            document.getElementById('roomId').value = '';
            document.getElementById('roomFormModal').style.display = 'flex';
        }

        // Edit room
        function editRoom(roomId) {
            const room = rooms.find(r => r.room_id === roomId);
            if (!room) return;
            
            document.getElementById('formModalTitle').textContent = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡πâ‡∏≠‡∏á';
            document.getElementById('roomId').value = room.room_id;
            document.getElementById('roomName').value = room.name;
            document.getElementById('roomType').value = room.type_id || '';
            document.getElementById('roomCapacity').value = room.capacity || '';
            document.getElementById('roomStatus').value = room.status;
            
            closeModal();
            document.getElementById('roomFormModal').style.display = 'flex';
        }

        // Delete room
        async function deleteRoom(roomId) {
            const room = rooms.find(r => r.room_id === roomId);
            if (!room) return;
            
            if (!confirm(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö "${room.name}" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) return;
            
            try {
                const token = localStorage.getItem('token');
                const response = await fetch(`${API_BASE}/admin/rooms/${roomId}`, {
                    method: 'DELETE',
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    alert('‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    loadRooms();
                } else {
                    throw new Error('Failed to delete room');
                }
            } catch (error) {
                console.error('Error deleting room:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏´‡πâ‡∏≠‡∏á');
            }
        }

        // Book room
        function bookRoom(roomId) {
            if (!currentUser) {
                alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏à‡∏≠‡∏á');
                window.location.href = '/auth';
                return;
            }
            
            window.location.href = `/bookings?room=${roomId}`;
        }

        // Handle room form submission
        document.getElementById('roomForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const roomId = document.getElementById('roomId').value;
            const roomData = {
                name: document.getElementById('roomName').value,
                type_id: parseInt(document.getElementById('roomType').value),
                capacity: parseInt(document.getElementById('roomCapacity').value),
                status: document.getElementById('roomStatus').value
            };
            
            try {
                const token = localStorage.getItem('token');
                const url = roomId ? 
                    `${API_BASE}/admin/rooms/${roomId}` : 
                    `${API_BASE}/admin/rooms`;
                const method = roomId ? 'PUT' : 'POST';
                
                const response = await fetch(url, {
                    method: method,
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify(roomData)
                });
                
                if (response.ok) {
                    alert(roomId ? '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à' : '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡πâ‡∏≠‡∏á‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                    closeFormModal();
                    loadRooms();
                } else {
                    const error = await response.json();
                    throw new Error(error.error || 'Operation failed');
                }
            } catch (error) {
                console.error('Error saving room:', error);
                alert(`‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${error.message}`);
            }
        });

        // Modal functions
        function closeModal() {
            document.getElementById('roomModal').style.display = 'none';
        }

        function closeFormModal() {
            document.getElementById('roomFormModal').style.display = 'none';
        }

        // Close modals when clicking outside
        document.getElementById('roomModal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('roomModal')) {
                closeModal();
            }
        });

        document.getElementById('roomFormModal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('roomFormModal')) {
                closeFormModal();
            }
        });
    </script>
    
    <!-- Shared authentication functions -->
    <script src="/javascripts/shared/auth.js"></script>
</body>
</html>